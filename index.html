<!DOCTYPE html><html lang="ar" dir="rtl"><head><meta charset="UTF-8"><title>Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ -  </title><script>/* * LICENSE PROTECTION SYSTEM - DO NOT MODIFY * AUTHOR: MICHAEL MAHER */(function(){    const _0xL = "https://michaelmaher923-cyber.github.io/Accountsite26/";    const _0xH = window.location.href;        // ÙØ­Øµ ØµØ§Ø±Ù… Ù„Ù„Ø±Ø§Ø¨Ø· Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ Ø§Ù„Ù€ Protocol ÙˆØ§Ù„Ù€ Path    if (!_0xH.startsWith(_0xL) && _0xH !== _0xL) {        window.stop();         document.documentElement.innerHTML = `        <div style="height:100vh; display:flex; align-items:center; justify-content:center; background:#0f172a; color:#f43f5e; font-family:sans-serif; text-align:center; padding:20px;">            <div>                <h1 style="font-size:50px;">ğŸ›‘</h1>                <h2>Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ±Ø®ÙŠØµ (License Error)</h2>                <p>Ù‡Ø°Ù‡ Ø§Ù„Ù†Ø³Ø®Ø© ØºÙŠØ± Ù…ØµØ±Ø­ Ø¨ØªØ´ØºÙŠÙ„Ù‡Ø§ Ø®Ø§Ø±Ø¬ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø±Ø³Ù…ÙŠ.</p>                <p style="direction:ltr; color:#94a3b8;">${_0xL}</p>            </div>        </div>`;        throw new Error("Unauthorized Domain");    }    // Ù…Ù†Ø¹ Ø²Ø± Ø§Ù„ÙØ£Ø±Ø© Ø§Ù„Ø£ÙŠÙ…Ù† ÙˆØ¨Ø¹Ø¶ Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ†    document.addEventListener('contextmenu', e => e.preventDefault());    document.onkeydown = function(e) {        if(e.keyCode == 123 || (e.ctrlKey && e.shiftKey && (e.keyCode == 'I'.charCodeAt(0) || e.keyCode == 'J'.charCodeAt(0) || e.keyCode == 'C'.charCodeAt(0))) || (e.ctrlKey && e.keyCode == 'U'.charCodeAt(0))) return false;    };})();</script><style>:root{--main:#1e293b;--accent:#0284c7;--bg:#f8fafc;--white:#ffffff;--danger:#be123c;--success:#059669}body{font-family:'Segoe UI',Tahoma,sans-serif;background:var(--bg);margin:0;color:#334155}header{background:var(--main);color:white;padding:15px 30px;display:flex;justify-content:space-between;align-items:center}.logo-img{width:40px;height:40px;background:var(--accent);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:20px}.page{display:none;padding:25px}.page.active{display:block}.table-container{background:var(--white);padding:20px;border-radius:12px;box-shadow:0 4px 6px -1px rgba(0,0,0,.1);overflow-x:auto;margin-bottom:20px}table{width:100%;border-collapse:collapse;margin-top:10px}th{background:#f1f5f9;padding:12px;border:1px solid #e2e8f0;font-size:13px;color:var(--main)}td{padding:8px;border:1px solid #e2e8f0;text-align:center}input,select{width:92%;padding:8px;border:1px solid #cbd5e1;border-radius:4px;font-size:14px}input[readonly]{background-color:#f1f5f9;color:#64748b;cursor:not-allowed}.btn{padding:10px 20px;border:none;border-radius:6px;cursor:pointer;font-weight:700;transition:.2s}.btn-save{background:var(--success);color:white}.btn-del{background:var(--danger);color:white}.btn-add{background:var(--main);color:white;margin-bottom:15px}.nav-menu{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:15px;padding:20px}.card{background:#fff;padding:25px;border-radius:12px;text-align:center;cursor:pointer;border:1px solid #e2e8f0;transition:.3s}.card:hover{border-color:var(--accent);transform:translateY(-3px);box-shadow:0 10px 15px -3px rgba(0,0,0,.1)}.auth-box{max-width:400px;margin:80px auto;background:#fff;padding:30px;border-radius:15px;box-shadow:0 20px 25px -5px rgba(0,0,0,.1);text-align:center}.tabs{display:flex;margin-bottom:20px;border-bottom:2px solid #f1f5f9}.tab{flex:1;padding:10px;cursor:pointer;font-weight:700;color:#94a3b8}.tab.active{color:var(--accent);border-bottom:2px solid var(--accent)}#loader{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(255,255,255,.8);z-index:9999;justify-content:center;align-items:center;flex-direction:column}.report-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px}.total-row{background:#f8fafc;font-weight:700}.info-box{background:#fffbeb;border-right:5px solid #f59e0b;padding:15px;margin-bottom:15px;text-align:right;border-radius:4px}.info-box h4{margin-top:0;color:#92400e}.info-box ul{padding-right:20px}.info-box li{margin-bottom:8px;line-height:1.6}</style></head><body><div id="loader"><b>â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„...</b></div><div id="authScreen" class="auth-box">    <div class="logo-img" style="margin: 0 auto 20px; width: 60px; height: 60px; font-size: 30px;">ğŸ“ˆ</div>    <div class="tabs"><div id="loginTab" class="tab active" onclick="switchAuth(true)">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</div><div id="registerTab" class="tab" onclick="switchAuth(false)">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</div></div>    <input type="text" id="username" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" style="margin-bottom:15px; width:100%;">    <input type="password" id="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" style="margin-bottom:5px; width:100%;">    <p style="font-size: 11px; color: var(--danger); margin-bottom: 10px;">* ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† Ù„Ø§ ØªÙ‚Ù„ Ø¹Ù† 6 Ø£Ø­Ø±Ù Ø£Ùˆ Ø£Ø±Ù‚Ø§Ù…</p>    <button class="btn btn-save" style="width:100%" onclick="processAuth()">Ø¯Ø®ÙˆÙ„</button></div><div id="appScreen" style="display:none;">    <header>        <div style="display:flex; align-items:center; gap:12px;"><div class="logo-img">ğŸ“‰</div><h2 style="margin:0">Ø§Ù„Ù…Ø­Ø§Ø³Ø¨</h2></div>        <div style="display:flex; align-items:center; gap:15px;">            <span id="userDisplay" style="font-weight: bold;"></span>            <button class="btn btn-save" onclick="syncToCloud()" style="background:var(--success)">Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>            <button class="btn btn-del" onclick="logout()">Ø®Ø±ÙˆØ¬</button>        </div>    </header>    <div id="homePage" class="page active">        <div class="nav-menu">            <div class="card" onclick="openPage('accountsPage')"><h3>ğŸ“ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</h3></div>            <div class="card" onclick="openPage('journalPage')"><h3>ğŸ““ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h3></div>            <div class="card" onclick="openPage('productsPage')"><h3>ğŸ“¦ Ø§Ù„Ù…Ø®Ø²Ù†</h3></div>            <div class="card" onclick="openPage('partnersPage')"><h3>ğŸ¤ Ø§Ù„Ù…ØªØ¹Ø§Ù…Ù„ÙˆÙ†</h3></div>            <div class="card" onclick="openPage('trialPage')"><h3>âš–ï¸ Ø§Ù„Ù…ÙŠØ²Ø§Ù†</h3></div>            <div class="card" onclick="openPage('incomePage')" style="background: #f0fdf4;"><h3>ğŸ“Š Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø®Ù„</h3></div>            <div class="card" onclick="openPage('balanceSheetPage')" style="background: #eff6ff;"><h3>ğŸ¦ Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ù…Ø§Ù„ÙŠ</h3></div>            <div class="card" onclick="openPage('guidePage')" style="background: #fffbeb; border: 1px dashed #f59e0b;"><h3>ğŸ“– Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</h3></div>        </div>        <div style="text-align:center; color:#94a3b8; font-size:12px; margin-top:20px;">Ø¥Ø¹Ø¯Ø§Ø¯ : Ø£ Ù…Ø§ÙŠÙƒÙ„ Ù…Ø§Ù‡Ø±</div>    </div>    <div id="guidePage" class="page"><button class="btn btn-add" onclick="openPage('homePage')">â¬… Ø±Ø¬ÙˆØ¹</button><div class="table-container"> <h2 style="text-align: center; color: var(--accent);">ğŸ“– Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠ</h2> <div class="info-box"> <h4>1ï¸âƒ£ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„Ù…Ø³ØªÙ…Ø±</h4> <ul> <li>Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ ÙŠØ¹Ù…Ù„ Ø¨Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„Ù…Ø³ØªÙ…Ø±.</li> </ul> </div> </div> </div>    <div id="accountsPage" class="page"><button class="btn btn-add" onclick="openPage('homePage')">â¬… Ø±Ø¬ÙˆØ¹</button><div class="table-container"><h3>Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</h3><button class="btn btn-add" onclick="addAcc()">+ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</button><table><thead><tr><th>Ø§Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨</th><th>Ø§Ù„Ù†ÙˆØ¹</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th></tr></thead><tbody id="accountsBody"></tbody></table></div></div>    <div id="journalPage" class="page"><button class="btn btn-add" onclick="openPage('homePage')">â¬… Ø±Ø¬ÙˆØ¹</button><div class="table-container"><button class="btn btn-add" onclick="addJ()">+ Ù‚ÙŠØ¯ Ø¬Ø¯ÙŠØ¯</button><table><thead><tr><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ù…Ø¯ÙŠÙ†</th><th>Ø¯Ø§Ø¦Ù†</th><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„ØµÙ†Ù</th><th>Ø§Ù„ÙƒÙ…ÙŠØ©</th><th>Ø§Ù„Ù…Ø¨Ù„Øº</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th></tr></thead><tbody id="journalBody"></tbody></table></div></div>    <div id="productsPage" class="page"><button class="btn btn-add" onclick="openPage('homePage')">â¬… Ø±Ø¬ÙˆØ¹</button><div class="table-container"><button class="btn btn-add" onclick="addP()">+ ØµÙ†Ù Ø¬Ø¯ÙŠØ¯</button><table><thead><tr><th>Ø§Ù„ØµÙ†Ù</th><th>Ø§Ù„Ø³Ø¹Ø±</th><th>Ø±ØµÙŠØ¯ Ø£ÙˆÙ„</th><th>Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th></tr></thead><tbody id="productsBody"></tbody></table></div></div>    <div id="partnersPage" class="page"><button class="btn btn-add" onclick="openPage('homePage')">â¬… Ø±Ø¬ÙˆØ¹</button><div class="table-container"><h3>Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…ØªØ¹Ø§Ù…Ù„ÙŠÙ† ÙˆØ§Ù„Ø¯ÙŠÙˆÙ†</h3><button class="btn btn-add" onclick="addPartnerInfo()">+ Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª Ù…ØªØ¹Ø§Ù…Ù„</button><table><thead><tr><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ù‡Ø§ØªÙ</th><th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th><th>Ù…Ø¯ÙŠÙ† (+)</th><th>Ø¯Ø§Ø¦Ù† (-)</th><th>Ø§Ù„ØµØ§ÙÙŠ</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th></tr></thead><tbody id="partnersBody"></tbody></table></div></div>    <div id="trialPage" class="page"><button class="btn btn-add" onclick="openPage('homePage')">â¬… Ø±Ø¬ÙˆØ¹</button><div class="table-container"><table><thead><tr><th>Ø§Ù„Ø­Ø³Ø§Ø¨</th><th>Ù…Ø¯ÙŠÙ†</th><th>Ø¯Ø§Ø¦Ù†</th><th>Ø±ØµÙŠØ¯ Ù…</th><th>Ø±ØµÙŠØ¯ Ø¯</th></tr></thead><tbody id="trialBody"></tbody></table></div></div>    <div id="incomePage" class="page"><button class="btn btn-add" onclick="openPage('homePage')">â¬… Ø±Ø¬ÙˆØ¹</button><div class="table-container"><h2 style="text-align: center;">ğŸ“Š Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø®Ù„</h2><table><tbody id="incomeBody"></tbody></table></div></div>    <div id="balanceSheetPage" class="page"><button class="btn btn-add" onclick="openPage('homePage')">â¬… Ø±Ø¬ÙˆØ¹</button><div class="report-grid"><div class="table-container"><h3>Ø§Ù„Ø£ØµÙˆÙ„</h3><table><thead><tr><th>Ø§Ù„Ø­Ø³Ø§Ø¨</th><th>Ø§Ù„Ù…Ø¨Ù„Øº</th></tr></thead><tbody id="assetsBody"></tbody></table></div><div class="table-container"><h3>Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª</h3><table><thead><tr><th>Ø§Ù„Ø­Ø³Ø§Ø¨</th><th>Ø§Ù„Ù…Ø¨Ù„Øº</th></tr></thead><tbody id="liabilitiesBody"></tbody></table></div></div></div></div><datalist id="accList"></datalist><datalist id="partnerList"></datalist><script type="module">import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";import { getDatabase, ref, set, get } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";const _fbc = {    apiKey: "AIzaSyBP7HP1w4MbOFZWnv7BdpKwDlYjv4VJUTM",    authDomain: "accountsite26.firebaseapp.com",    databaseURL: "https://accountsite26-default-rtdb.firebaseio.com",    projectId: "accountsite26",    storageBucket: "accountsite26.firebasestorage.app",    messagingSenderId: "1015795938039",    appId: "1:1015795938039:web:b625e24fca2c5b231d19f2"};const app = initializeApp(_fbc);const db = getDatabase(app);const auth = getAuth(app);// Ø¯Ù…Ø¬ Ø§Ù„Ø¯ÙˆØ§Ù„ ÙˆØªØ¹Ù…ÙŠØªÙ‡Ø§ Ø¨Ø±Ù…Ø¬ÙŠØ§Ù‹window.processAuth=async()=>{const u=document.getElementById('username').value.trim(),p=document.getElementById('password').value.trim(),isL=document.getElementById('loginTab').classList.contains('active');if(!u||!p)return alert("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");if(p.length<6)return alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¶Ø¹ÙŠÙØ©");document.getElementById('loader').style.display='flex';const e=u.toLowerCase().replace(/[^a-z0-9]/g,"")+"@maher.com";try{if(isL)await signInWithEmailAndPassword(auth,e,p);else await createUserWithEmailAndPassword(auth,e,p)}catch(err){alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");document.getElementById('loader').style.display='none'}};onAuthStateChanged(auth,async(user)=>{if(user){window.currentUser=user.email.split('@')[0];const snap=await get(ref(db,`users/${user.uid}/data`));const d=snap.exists()?snap.val():{};window.userDB={accounts:d.accounts||[],journal:d.journal||[],products:d.products||[],partnersInfo:d.partnersInfo||[]};initFixedAccounts();startApp()}});window.syncToCloud=async()=>{if(!auth.currentUser)return;document.getElementById('loader').style.display='flex';try{await set(ref(db,`users/${auth.currentUser.uid}/data`),window.userDB);alert("âœ… ØªÙ… Ø§Ù„Ø­ÙØ¸")}catch(e){alert("âŒ ÙØ´Ù„")}document.getElementById('loader').style.display='none'};window.logout=()=>{signOut(auth).then(()=>location.reload())};</script><script>// Ø§Ù„Ù…Ø­Ø±Ùƒ Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠ Ø§Ù„Ù…Ø´ÙØ± (Logics)const FIXED_ACCOUNTS=["Ø§Ù„Ù…Ø®Ø²ÙˆÙ†","Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡","Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†","Ø§Ù„Ù…Ø¯ÙŠÙ†ÙˆÙ†","Ø§Ù„Ø¯Ø§Ø¦Ù†ÙˆÙ†"],ACC_TYPES=["Ø£ØµÙˆÙ„","Ø§Ù„ØªØ²Ø§Ù…Ø§Øª","Ø­Ù‚ÙˆÙ‚ Ù…Ù„ÙƒÙŠØ©","Ù…Ø¨ÙŠØ¹Ø§Øª","ØªÙƒÙ„ÙØ© Ù…Ø¨ÙŠØ¹Ø§Øª","Ù…ØµØ±ÙˆÙØ§Øª","Ø¥ÙŠØ±Ø§Ø¯Ø§Øª","Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø£Ø®Ø±Ù‰","Ù…ØµØ±ÙˆÙØ§Øª Ø§Ø®Ø±Ù‰","ØºÙŠØ± Ø°Ù„Ùƒ"];window.currentUser="",window.userDB={accounts:[],journal:[],products:[],partnersInfo:[]};function switchAuth(m){document.getElementById('loginTab').classList.toggle('active',m),document.getElementById('registerTab').classList.toggle('active',!m)}function initFixedAccounts(){userDB.accounts||(userDB.accounts=[]),FIXED_ACCOUNTS.forEach(n=>{userDB.accounts.find(a=>a.name===n)||(userDB.accounts.push({name:n,type:n==="Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†"||n==="Ø§Ù„Ø¯Ø§Ø¦Ù†ÙˆÙ†"?"Ø§Ù„ØªØ²Ø§Ù…Ø§Øª":"Ø£ØµÙˆÙ„",fixed:!0}))})}function startApp(){document.getElementById('authScreen').style.display='none',document.getElementById('appScreen').style.display='block',document.getElementById('loader').style.display='none',document.getElementById('userDisplay').innerText="ğŸ‘¤ "+currentUser,updateDatalists(),openPage('homePage')}function openPage(id){document.querySelectorAll('.page').forEach(p=>p.classList.remove('active')),document.getElementById(id).classList.add('active'),render(id)}function updateDatalists(){const a=document.getElementById('accList'),p=document.getElementById('partnerList');a.innerHTML='',p.innerHTML='',userDB.accounts.forEach(x=>a.innerHTML+=`<option value="${x.name}">`),userDB.partnersInfo.forEach(x=>p.innerHTML+=`<option value="${x.name}">`)}function getTrialBalances(){let a={};userDB.accounts.forEach(x=>a[x.name]={d:0,c:0,type:x.type}),userDB.journal.forEach(j=>{a[j.deb]&&(a[j.deb].d+=parseFloat(j.v)||0),a[j.cre]&&(a[j.cre].c+=parseFloat(j.v)||0)});let r=[];for(let n in a){let b=a[n].d-a[n].c;r.push({name:n,type:a[n].type,balance:b,d:a[n].d,c:a[n].c})}return r}function calculateNetProfit(){let b=getTrialBalances(),s=t=>b.filter(x=>x.type===t).reduce((a,c)=>a+Math.abs(c.balance),0);return(s('Ù…Ø¨ÙŠØ¹Ø§Øª')-s('ØªÙƒÙ„ÙØ© Ù…Ø¨ÙŠØ¹Ø§Øª'))+(s('Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø£Ø®Ø±Ù‰')+s('Ø¥ÙŠØ±Ø§Ø¯Ø§Øª'))-(s('Ù…ØµØ±ÙˆÙØ§Øª Ø§Ø®Ø±Ù‰')+s('Ù…ØµØ±ÙˆÙØ§Øª'))}function render(id){if(id==='accountsPage'){let b=document.getElementById('accountsBody');b.innerHTML='',userDB.accounts.forEach((a,i)=>{let o=ACC_TYPES.map(t=>`<option ${a.type==t?'selected':''}>${t}</option>`).join('');b.innerHTML+=`<tr><td><input value="${a.name}" ${a.fixed?'readonly':''} onchange="userDB.accounts[${i}].name=this.value;updateDatalists()"></td><td><select onchange="userDB.accounts[${i}].type=this.value">${o}</select></td><td>${a.fixed?'ğŸ”’':`<button class="btn btn-del" onclick="userDB.accounts.splice(${i},1);render('accountsPage')">ğŸ—‘ï¸</button>`}</td></tr>`})}if(id==='journalPage'){let b=document.getElementById('journalBody');b.innerHTML='',userDB.journal.forEach((j,i)=>{let p=`<option value="">-- ØµÙ†Ù --</option>`+userDB.products.map(x=>`<option value="${x.name}" ${j.prod===x.name?'selected':''}>${x.name}</option>`).join('');b.innerHTML+=`<tr><td><input type="date" value="${j.date||''}" onchange="userDB.journal[${i}].date=this.value"></td><td><input list="accList" value="${j.deb||''}" onchange="userDB.journal[${i}].deb=this.value"></td><td><input list="accList" value="${j.cre||''}" onchange="userDB.journal[${i}].cre=this.value"></td><td><input list="partnerList" value="${j.name||''}" onchange="userDB.journal[${i}].name=this.value"></td><td><select onchange="updateRowPrice(${i},this.value)">${p}</select></td><td><input type="number" id="q${i}" value="${j.q||0}" oninput="validateStock(${i})"></td><td><input type="number" id="v${i}" value="${j.v||0}" oninput="userDB.journal[${i}].v=this.value"></td><td><button class="btn btn-save" onclick="render('journalPage')">ğŸ’¾</button> <button class="btn btn-del" onclick="userDB.journal.splice(${i},1);render('journalPage')">ğŸ—‘ï¸</button></td></tr>`})}if(id==='productsPage'){let b=document.getElementById('productsBody');b.innerHTML='',userDB.products.forEach((p,i)=>{let c=parseFloat(p.op)||0;userDB.journal.forEach(j=>{if(j.prod===p.name){if(j.deb==="Ø§Ù„Ù…Ø®Ø²ÙˆÙ†")c+=parseFloat(j.q);if(j.cre==="Ø§Ù„Ù…Ø®Ø²ÙˆÙ†")c-=parseFloat(j.q)}});b.innerHTML+=`<tr><td><input value="${p.name||''}" onchange="userDB.products[${i}].name=this.value"></td><td><input type="number" value="${p.price||0}" onchange="userDB.products[${i}].price=this.value"></td><td><input type="number" value="${p.op||0}" onchange="userDB.products[${i}].op=this.value"></td><td>${c}</td><td><button class="btn btn-del" onclick="userDB.products.splice(${i},1);render('productsPage')">ğŸ—‘ï¸</button></td></tr>`})}if(id==='trialPage'){let b=document.getElementById('trialBody');b.innerHTML='',getTrialBalances().forEach(a=>b.innerHTML+=`<tr><td>${a.name}</td><td>${a.d}</td><td>${a.c}</td><td>${a.balance>0?a.balance:0}</td><td>${a.balance<0?Math.abs(a.balance):0}</td></tr>`)}if(id==='incomePage'){let b=document.getElementById('incomeBody');b.innerHTML='';let bl=getTrialBalances(),s=t=>bl.filter(x=>x.type===t).reduce((a,c)=>a+Math.abs(c.balance),0),m=s('Ù…Ø¨ÙŠØ¹Ø§Øª'),co=s('ØªÙƒÙ„ÙØ© Ù…Ø¨ÙŠØ¹Ø§Øª'),mo=m-co,or=s('Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø£Ø®Ø±Ù‰')+s('Ø¥ÙŠØ±Ø§Ø¯Ø§Øª'),oe=s('Ù…ØµØ±ÙˆÙØ§Øª Ø§Ø®Ø±Ù‰')+s('Ù…ØµØ±ÙˆÙØ§Øª'),n=mo+or-oe;b.innerHTML=`<tr><td>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</td><td>${m}</td></tr><tr><td>(-) ØªÙƒÙ„ÙØ© Ø§Ù„Ø¨Ø¶Ø§Ø¹Ø©</td><td>${co}</td></tr><tr class="total-row"><td>Ù…Ø¬Ù…Ù„ Ø§Ù„Ø±Ø¨Ø­</td><td>${mo}</td></tr><tr><td>(+) Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø£Ø®Ø±Ù‰</td><td>${or}</td></tr><tr><td>(-) Ù…ØµØ±ÙˆÙØ§Øª</td><td>${oe}</td></tr><tr class="total-row" style="background:#dcfce7"><td>ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­</td><td>${n}</td></tr>`}if(id==='balanceSheetPage'){let bl=getTrialBalances(),ab=document.getElementById('assetsBody'),lb=document.getElementById('liabilitiesBody');ab.innerHTML='',lb.innerHTML='';let tA=0,tL=0;bl.forEach(a=>{if(a.type==='Ø£ØµÙˆÙ„'&&(a.balance!==0||a.d!==0)){let v=a.balance>0?a.balance:a.d;tA+=v,ab.innerHTML+=`<tr><td>${a.name}</td><td>${v}</td></tr>`}if(['Ø§Ù„ØªØ²Ø§Ù…Ø§Øª','Ø­Ù‚ÙˆÙ‚ Ù…Ù„ÙƒÙŠØ©'].includes(a.type)&&(a.balance!==0||a.c!==0)){let v=a.balance<0?Math.abs(a.balance):a.c;tL+=v,lb.innerHTML+=`<tr><td>${a.name}</td><td>${v}</td></tr>` }});let net=calculateNetProfit();tL+=net,lb.innerHTML+=`<tr style="background:#f0fdf4; font-weight:bold; color:var(--success)"><td>ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­</td><td>${net}</td></tr>`,ab.innerHTML+=`<tr class="total-row"><td>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</td><td>${tA}</td></tr>`,lb.innerHTML+=`<tr class="total-row"><td>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</td><td>${tL}</td></tr>` }if(id==='partnersPage'){const b=document.getElementById('partnersBody');b.innerHTML='';let pCalc={};userDB.journal.forEach(j=>{if(j.name){let n=j.name.trim();if(!pCalc[n])pCalc[n]={d:0,c:0};let v=parseFloat(j.v)||0;if(["Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡","Ø§Ù„Ù…Ø¯ÙŠÙ†ÙˆÙ†","Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†","Ø§Ù„Ø¯Ø§Ø¦Ù†ÙˆÙ†"].includes(j.deb))pCalc[n].d+=v;if(["Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡","Ø§Ù„Ù…Ø¯ÙŠÙ†ÙˆÙ†","Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†","Ø§Ù„Ø¯Ø§Ø¦Ù†ÙˆÙ†"].includes(j.cre))pCalc[n].c+=v}});userDB.partnersInfo.forEach((p,i)=>{let d=pCalc[p.name]?pCalc[p.name].d:0,c=pCalc[p.name]?pCalc[p.name].c:0,net=d-c;b.innerHTML+=`<tr><td><input value="${p.name}" onchange="userDB.partnersInfo[${i}].name=this.value;updateDatalists()"></td><td><input value="${p.phone||''}" onchange="userDB.partnersInfo[${i}].phone=this.value"></td><td><input value="${p.note||''}" onchange="userDB.partnersInfo[${i}].note=this.value"></td><td style="color:blue">${d}</td><td style="color:orange">${c}</td><td style="font-weight:bold; color:${net>=0?'green':'red'}">${net}</td><td><button class="btn btn-del" onclick="userDB.partnersInfo.splice(${i},1);render('partnersPage')">ğŸ—‘ï¸</button></td></tr>`})}}function validateStock(i){let j=userDB.journal[i];if(j.cre==="Ø§Ù„Ù…Ø®Ø²ÙˆÙ†"&&j.prod){let p=userDB.products.find(x=>x.name===j.prod),c=parseFloat(p.op)||0;userDB.journal.forEach((jj,x)=>{if(x!==i&&jj.prod===j.prod){if(jj.deb==="Ø§Ù„Ù…Ø®Ø²ÙˆÙ†")c+=parseFloat(jj.q)||0;if(jj.cre==="Ø§Ù„Ù…Ø®Ø²ÙˆÙ†")c-=parseFloat(jj.q)||0}});if(parseFloat(document.getElementById('q'+i).value)>c){alert("Ø§Ù„Ù…ØªØ§Ø­: "+c);document.getElementById('q'+i).value=0}}calcRowVal(i)}function updateRowPrice(i,n){const p=userDB.products.find(x=>x.name===n);userDB.journal[i].prod=n;if(p){document.getElementById('v'+i).value=(parseFloat(p.price)||0)*(parseFloat(document.getElementById('q'+i).value)||0);userDB.journal[i].v=document.getElementById('v'+i).value}}function calcRowVal(i){userDB.journal[i].q=document.getElementById('q'+i).value;const p=userDB.products.find(x=>x.name===userDB.journal[i].prod);if(p){document.getElementById('v'+i).value=(parseFloat(p.price)||0)*(parseFloat(userDB.journal[i].q)||0);userDB.journal[i].v=document.getElementById('v'+i).value}}function addAcc(){userDB.accounts.push({name:'',type:'Ø£ØµÙˆÙ„',fixed:!1}),render('accountsPage')}function addJ(){userDB.journal.push({date:new Date().toISOString().split('T')[0],q:0,v:0,deb:'',cre:'',name:'',prod:''}),render('journalPage')}function addP(){userDB.products.push({name:'',price:0,op:0}),render('productsPage')}function addPartnerInfo(){userDB.partnersInfo.push({name:'',phone:'',note:''}),render('partnersPage')}</script></body></html>