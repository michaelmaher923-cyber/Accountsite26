<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ø§Ù„Ù…Ø­Ø§Ø³Ø¨</title>
    <style>
        :root { --main: #1e293b; --accent: #0284c7; --bg: #f8fafc; --white: #ffffff; --danger: #be123c; --success: #059669; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); margin: 0; color: #334155; }
        header { background: var(--main); color: white; padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; }
        .logo-img { width: 40px; height: 40px; background: var(--accent); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 20px; }
        .page { display: none; padding: 25px; }
        .page.active { display: block; }
        .table-container { background: var(--white); padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); overflow-x: auto; margin-bottom: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th { background: #f1f5f9; padding: 12px; border: 1px solid #e2e8f0; font-size: 13px; color: var(--main); }
        td { padding: 8px; border: 1px solid #e2e8f0; text-align: center; }
        input, select { width: 92%; padding: 8px; border: 1px solid #cbd5e1; border-radius: 4px; font-size: 14px; }
        input[readonly] { background-color: #f1f5f9; color: #64748b; cursor: not-allowed; }
        .btn { padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .btn-save { background: var(--success); color: white; }
        .btn-del { background: var(--danger); color: white; }
        .btn-add { background: var(--main); color: white; margin-bottom: 15px; }
        .nav-menu { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 15px; padding: 20px; }
        .card { background: white; padding: 25px; border-radius: 12px; text-align: center; cursor: pointer; border: 1px solid #e2e8f0; transition: 0.3s; }
        .card:hover { border-color: var(--accent); transform: translateY(-3px); box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); }
        .auth-box { max-width: 400px; margin: 80px auto; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1); text-align: center; }
        .tabs { display: flex; margin-bottom: 20px; border-bottom: 2px solid #f1f5f9; }
        .tab { flex: 1; padding: 10px; cursor: pointer; font-weight: bold; color: #94a3b8; }
        .tab.active { color: var(--accent); border-bottom: 2px solid var(--accent); }
        #loader { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(255,255,255,0.8); z-index:9999; justify-content:center; align-items:center; flex-direction:column; }
        .report-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .total-row { background: #f8fafc; font-weight: bold; }
        .info-box { background: #fffbeb; border-right: 5px solid #f59e0b; padding: 15px; margin-bottom: 15px; text-align: right; border-radius: 4px; }
        .info-box h4 { margin-top: 0; color: #92400e; }
        .info-box ul { padding-right: 20px; }
        .info-box li { margin-bottom: 8px; line-height: 1.6; }
    </style>
</head>
<body>

<div id="loader"><b>â³ Ø¬Ø§Ø±ÙŠ ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ± ÙˆØ§Ù„ØªØ­Ù‚Ù‚...</b></div>

<div id="authScreen" class="auth-box">
    <div class="logo-img" style="margin: 0 auto 20px; width: 60px; height: 60px; font-size: 30px;">ğŸ“ˆ</div>
    <div class="tabs">
        <div id="loginTab" class="tab active" onclick="switchAuth(true)">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</div>
        <div id="registerTab" class="tab" onclick="switchAuth(false)">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</div>
    </div>
    <input type="text" id="username" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" style="margin-bottom:15px; width:100%;">
    <input type="password" id="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" style="margin-bottom:5px; width:100%;">
    <p style="font-size: 11px; color: var(--danger); margin-bottom: 10px;">* ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† Ù„Ø§ ØªÙ‚Ù„ Ø¹Ù† 6 Ø£Ø­Ø±Ù Ø£Ùˆ Ø£Ø±Ù‚Ø§Ù…</p>
    <button class="btn btn-save" style="width:100%" onclick="processAuth()">Ø¯Ø®ÙˆÙ„</button>
</div>

<div id="appScreen" style="display:none;">
    <header>
        <div style="display:flex; align-items:center; gap:12px;"><div class="logo-img">ğŸ“‰</div><h2 style="margin:0">Ø§Ù„Ù…Ø­Ø§Ø³Ø¨</h2></div>
        <div style="display:flex; align-items:center; gap:15px;">
            <span id="userDisplay" style="font-weight: bold;"></span>
            <button class="btn btn-save" onclick="syncToCloud()" style="background:var(--success)">Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
            <button class="btn btn-del" onclick="logout()">Ø®Ø±ÙˆØ¬</button>
        </div>
    </header>

    <div id="homePage" class="page active">
        <div class="nav-menu">
            <div class="card" onclick="openPage('accountsPage')"><h3>ğŸ“ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</h3></div>
            <div class="card" onclick="openPage('journalPage')"><h3>ğŸ““ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h3></div>
            <div class="card" onclick="openPage('productsPage')"><h3>ğŸ“¦ Ø§Ù„Ù…Ø®Ø²Ù†</h3></div>
            <div class="card" onclick="openPage('partnersPage')"><h3>ğŸ¤ Ø§Ù„Ù…ØªØ¹Ø§Ù…Ù„ÙˆÙ†</h3></div>
            <div class="card" onclick="openPage('trialPage')"><h3>âš–ï¸ Ø§Ù„Ù…ÙŠØ²Ø§Ù†</h3></div>
            <div class="card" onclick="openPage('incomePage')" style="background: #f0fdf4;"><h3>ğŸ“Š Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø®Ù„</h3></div>
            <div class="card" onclick="openPage('balanceSheetPage')" style="background: #eff6ff;"><h3>ğŸ¦ Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ù…Ø§Ù„ÙŠ</h3></div>
            <div class="card" onclick="openPage('guidePage')" style="background: #fffbeb; border: 1px dashed #f59e0b;"><h3>ğŸ“– Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</h3></div>
        </div>
        <div style="text-align:center; color:#94a3b8; font-size:12px; margin-top:20px;">Ø¥Ø¹Ø¯Ø§Ø¯ : Ø£ Ù…Ø§ÙŠÙƒÙ„ Ù…Ø§Ù‡Ø±</div>
    </div>

    <div id="guidePage" class="page">
        <button class="btn btn-add" onclick="openPage('homePage')">â¬… Ø±Ø¬ÙˆØ¹</button>
        <div class="table-container">
            <h2 style="text-align: center; color: var(--accent);">ğŸ“– Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠ ÙˆØ·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</h2>
            <div class="info-box"><h4>1ï¸âƒ£ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„Ù…Ø³ØªÙ…Ø±</h4><ul><li>Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ ÙŠØ¹Ù…Ù„ Ø¨Ù†Ø¸Ø§Ù… <b>Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„Ù…Ø³ØªÙ…Ø±</b>.</li><li>Ø¹Ù†Ø¯ Ø§Ù„Ø´Ø±Ø§Ø¡: ÙŠÙƒÙˆÙ† "Ø§Ù„Ù…Ø®Ø²ÙˆÙ†" Ù…Ø¯ÙŠÙ†Ø§Ù‹. Ø¹Ù†Ø¯ Ø§Ù„Ø¨ÙŠØ¹: ÙŠÙƒÙˆÙ† "Ø§Ù„Ù…Ø®Ø²ÙˆÙ†" Ø¯Ø§Ø¦Ù†Ø§Ù‹.</li></ul></div>
            <div class="info-box" style="border-right-color: #059669;"><h4>2ï¸âƒ£ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø²Ù† ÙˆØ§Ù„Ø£ØµÙ†Ø§Ù</h4><ul><li>Ø±ØµÙŠØ¯ Ø§Ù„Ø£ØµÙ†Ø§Ù ÙÙŠ ØµÙØ­Ø© "Ø§Ù„Ù…Ø®Ø²Ù†" ÙŠØ²ÙŠØ¯ Ø£Ùˆ ÙŠÙ†Ù‚Øµ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙŠÙˆØ¯.</li><li>ÙŠØ¬Ø¨ Ø§Ø®ØªÙŠØ§Ø± "Ø§Ù„ØµÙ†Ù" Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© Ù„Ø¶Ù…Ø§Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø±ÙƒØ©.</li></ul></div>
            <div class="info-box" style="border-right-color: #0284c7;"><h4>3ï¸âƒ£ Ø§Ù„Ù…ØªØ¹Ø§Ù…Ù„ÙˆÙ† ÙˆØ§Ù„Ø¯ÙŠÙˆÙ†</h4><ul><li>Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø£Ø´Ø®Ø§Øµ ØªØªØ£Ø«Ø± Ø¨Ø§Ù„Ù‚ÙŠÙˆØ¯ Ø§Ù„ØªÙŠ ØªØ´Ù…Ù„: <b>(Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ØŒ Ø§Ù„Ù…Ø¯ÙŠÙ†ÙˆÙ†ØŒ Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†ØŒ Ø§Ù„Ø¯Ø§Ø¦Ù†ÙˆÙ†)</b>.</li><li>ØªØ£ÙƒØ¯ Ù…Ù† ÙƒØªØ§Ø¨Ø© Ø§Ø³Ù… Ø§Ù„Ø´Ø®Øµ ÙÙŠ Ø®Ø§Ù†Ø© "Ø§Ù„Ø§Ø³Ù…" Ù„ÙŠØ¸Ù‡Ø± ÙÙŠ ÙƒØ´Ù Ø­Ø³Ø§Ø¨Ù‡.</li></ul></div>
            <div class="info-box" style="border-right-color: #be123c;"><h4>4ï¸âƒ£ ØªØ­Ø°ÙŠØ±Ø§Øª Ù‡Ø§Ù…Ø© (Ù„Ø§ ØªÙØ¹Ù„ Ø§Ù„Ø¢ØªÙŠ)</h4><ul><li><b>Ù„Ø§ ØªÙ‚Ù…</b> Ø¨ØªØºÙŠÙŠØ± Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ©.</li><li><b>Ù„Ø§ ØªØªØ±Ùƒ</b> Ø®Ø§Ù†Ø© Ø§Ù„Ù…Ø¨Ù„Øº ÙØ§Ø±ØºØ©.</li><li><b>Ù„Ø§ ØªÙ†Ø³Ù‰</b> Ø¶ØºØ· Ø²Ø± "Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª" Ù‚Ø¨Ù„ Ø§Ù„Ø®Ø±ÙˆØ¬.</li></ul></div>
        </div>
    </div>

    <div id="accountsPage" class="page"><button class="btn btn-add" onclick="openPage('homePage')">â¬… Ø±Ø¬ÙˆØ¹</button><div class="table-container"><h3>Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</h3><button class="btn btn-add" onclick="addAcc()">+ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</button><table><thead><tr><th>Ø§Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨</th><th>Ø§Ù„Ù†ÙˆØ¹</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th></tr></thead><tbody id="accountsBody"></tbody></table></div></div>
    <div id="journalPage" class="page"><button class="btn btn-add" onclick="openPage('homePage')">â¬… Ø±Ø¬ÙˆØ¹</button><div class="table-container"><button class="btn btn-add" onclick="addJ()">+ Ù‚ÙŠØ¯ Ø¬Ø¯ÙŠØ¯</button><table><thead><tr><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ù…Ø¯ÙŠÙ†</th><th>Ø¯Ø§Ø¦Ù†</th><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„ØµÙ†Ù</th><th>Ø§Ù„ÙƒÙ…ÙŠØ©</th><th>Ø§Ù„Ù…Ø¨Ù„Øº</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th></tr></thead><tbody id="journalBody"></tbody></table></div></div>
    <div id="productsPage" class="page"><button class="btn btn-add" onclick="openPage('homePage')">â¬… Ø±Ø¬ÙˆØ¹</button><div class="table-container"><button class="btn btn-add" onclick="addP()">+ ØµÙ†Ù Ø¬Ø¯ÙŠØ¯</button><table><thead><tr><th>Ø§Ù„ØµÙ†Ù</th><th>Ø§Ù„Ø³Ø¹Ø±</th><th>Ø±ØµÙŠØ¯ Ø£ÙˆÙ„</th><th>Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th></tr></thead><tbody id="productsBody"></tbody></table></div></div>
    <div id="partnersPage" class="page"><button class="btn btn-add" onclick="openPage('homePage')">â¬… Ø±Ø¬ÙˆØ¹</button><div class="table-container"><h3>Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…ØªØ¹Ø§Ù…Ù„ÙŠÙ† ÙˆØ§Ù„Ø¯ÙŠÙˆÙ†</h3><button class="btn btn-add" onclick="addPartnerInfo()">+ Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª Ù…ØªØ¹Ø§Ù…Ù„</button><table><thead><tr><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ù‡Ø§ØªÙ</th><th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th><th>Ù…Ø¯ÙŠÙ† (+)</th><th>Ø¯Ø§Ø¦Ù† (-)</th><th>Ø§Ù„ØµØ§ÙÙŠ</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th></tr></thead><tbody id="partnersBody"></tbody></table></div></div>
    <div id="trialPage" class="page"><button class="btn btn-add" onclick="openPage('homePage')">â¬… Ø±Ø¬ÙˆØ¹</button><div class="table-container"><table><thead><tr><th>Ø§Ù„Ø­Ø³Ø§Ø¨</th><th>Ù…Ø¯ÙŠÙ†</th><th>Ø¯Ø§Ø¦Ù†</th><th>Ø±ØµÙŠØ¯ Ù…</th><th>Ø±ØµÙŠØ¯ Ø¯</th></tr></thead><tbody id="trialBody"></tbody></table></div></div>
    <div id="incomePage" class="page"><button class="btn btn-add" onclick="openPage('homePage')">â¬… Ø±Ø¬ÙˆØ¹</button><div class="table-container"><h2 style="text-align: center;">ğŸ“Š Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø®Ù„</h2><table><tbody id="incomeBody"></tbody></table></div></div>
    <div id="balanceSheetPage" class="page">
        <button class="btn btn-add" onclick="openPage('homePage')">â¬… Ø±Ø¬ÙˆØ¹</button>
        <div class="report-grid">
            <div class="table-container"><h3>Ø§Ù„Ø£ØµÙˆÙ„</h3><table><thead><tr><th>Ø§Ù„Ø­Ø³Ø§Ø¨</th><th>Ø§Ù„Ù…Ø¨Ù„Øº</th></tr></thead><tbody id="assetsBody"></tbody></table></div>
            <div class="table-container"><h3>Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª ÙˆØ­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©</h3><table><thead><tr><th>Ø§Ù„Ø­Ø³Ø§Ø¨</th><th>Ø§Ù„Ù…Ø¨Ù„Øº</th></tr></thead><tbody id="liabilitiesBody"></tbody></table></div>
        </div>
    </div>
</div>

<datalist id="accList"></datalist><datalist id="partnerList"></datalist>

<script type="module">
const _0xR=['\x6D\x69\x63\x68\x61\x65\x6C\x6D\x61\x68\x65\x72\x39\x32\x33\x2D\x63\x79\x62\x65\x72\x2E\x67\x69\x74\x68\x75\x62\x2E\x69\x6F','\x61\x63\x63\x6F\x75\x6E\x74\x73\x69\x74\x65\x32\x36\x2E\x66\x69\x72\x65\x62\x61\x73\x65\x61\x70\x70\x2E\x63\x6F\x6D'];
(function(){if(!_0xR.includes(window.location.hostname)&&window.location.hostname!==""){document.body.innerHTML="<div style='text-align:center;padding:50px;font-family:sans-serif;'><h1 style='color:red'>âš ï¸ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ±Ø®ÙŠØµ</h1><p>Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ù…Ø­Ù…ÙŠ ÙˆØ­ØµØ±ÙŠ Ù„Ù„Ø£Ø³ØªØ§Ø° <b>Ù…Ø§ÙŠÙƒÙ„ Ù…Ø§Ù‡Ø±</b> ÙˆÙ„Ø§ ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù†Ø·Ø§Ù‚.</p></div>";throw new Error();}})();
import{initializeApp}from"https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";import{getDatabase,ref,set,get}from"https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";import{getAuth,signInWithEmailAndPassword,createUserWithEmailAndPassword,onAuthStateChanged,signOut}from"https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
const _0xC={apiKey:atob("QUl6YVN5QlA3SFAxdzRNYk9GWldudjdCZHBLd0RsWWp2NFZKVVRN"),authDomain:_0xR[1],databaseURL:"https://accountsite26-default-rtdb.firebaseio.com",projectId:"accountsite26"};
const app=initializeApp(_0xC);const db=getDatabase(app);const auth=getAuth(app);
window.processAuth=async()=>{const u=document.getElementById('username').value.trim(),p=document.getElementById('password').value.trim(),isL=document.getElementById('loginTab').classList.contains('active');if(!u||!p)return alert("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");document.getElementById('loader').style.display='flex';const e=u.toLowerCase().replace(/[^a-z0-9]/g,"")+"@maher.com";try{if(isL)await signInWithEmailAndPassword(auth,e,p);else await createUserWithEmailAndPassword(auth,e,p);}catch(x){alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¯Ø®ÙˆÙ„");document.getElementById('loader').style.display='none';}};onAuthStateChanged(auth,async(u)=>{if(u){window.currentUser=u.email.split('@')[0];const s=await get(ref(db,`users/${u.uid}/data`));const d=s.exists()?s.val():{};window.userDB={accounts:d.accounts||[],journal:d.journal||[],products:d.products||[],partnersInfo:d.partnersInfo||[]};initFixedAccounts();startApp();}});window.syncToCloud=async()=>{if(!auth.currentUser)return;document.getElementById('loader').style.display='flex';try{await set(ref(db,`users/${auth.currentUser.uid}/data`),window.userDB);alert("âœ… ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­");}catch(e){alert("âŒ ÙØ´Ù„");}document.getElementById('loader').style.display='none';};window.logout=()=>{signOut(auth).then(()=>location.reload());};
</script>

<script>
/* Ø§Ù„Ù…Ø­Ø±Ùƒ Ø§Ù„Ø­Ø³Ø§Ø¨ÙŠ (Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ†ÙŠØ©) */
(function(){const _0xL=["\u0627\u0644\u0645\u062e\u0632\u0648\u0646","\u0627\u0644\u0639\u0645\u0644\u0627\u0621","\u0627\u0644\u0645\u0648\u0631\u062f\u064a\u0646","\u0627\u0644\u0645\u062f\u064a\u0646\u0648\u0646","\u0627\u0644\u062f\u0627\u0626\u0646\u0648\u0646"];const _0xT=["\u0623\u0635\u0648\u0644","\u0627\u0644\u062a\u0632\u0627\u0645\u0627\u062a","\u062d\u0642\u0648\u0642 \u0645\u0644\u0643\u064a\u0629","\u0645\u0628\u064a\u0639\u0627\u062a","\u062a\u0643\u0644\u0641\u0629 \u0645\u0628\u064a\u0639\u0627\u062a","\u0645\u0635\u0631\u0648\u0641\u0627\u062a","\u0625\u064a\u0631\u0627\u062f\u0627\u062a"];window.userDB={accounts:[],journal:[],products:[],partnersInfo:[]};window.switchAuth=function(m){document.getElementById('loginTab').classList.toggle('active',m);document.getElementById('registerTab').classList.toggle('active',!m)};window.initFixedAccounts=function(){_0xL.forEach(n=>{if(!userDB.accounts.find(a=>a.name===n)){let t=(n===_0xL[2]||n===_0xL[4])?_0xT[1]:_0xT[0];userDB.accounts.push({name:n,type:t,fixed:true})}})};window.startApp=function(){document.getElementById('authScreen').style.display='none';document.getElementById('appScreen').style.display='block';document.getElementById('loader').style.display='none';document.getElementById('userDisplay').innerText="ğŸ‘¤ "+currentUser;updateDatalists();openPage('homePage')};window.openPage=function(id){document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));document.getElementById(id).classList.add('active');render(id)};window.updateDatalists=function(){const dl=document.getElementById('accList'),pl=document.getElementById('partnerList');dl.innerHTML='';pl.innerHTML='';userDB.accounts.forEach(a=>dl.innerHTML+=`<option value="${a.name}">`);userDB.partnersInfo.forEach(p=>pl.innerHTML+=`<option value="${p.name}">`)};window.getTrialBalances=function(){let accs={};userDB.accounts.forEach(a=>{accs[a.name]={d:0,c:0,type:a.type}});userDB.journal.forEach(j=>{if(accs[j.deb])accs[j.deb].d+=parseFloat(j.v)||0;if(accs[j.cre])accs[j.cre].c+=parseFloat(j.v)||0});return Object.keys(accs).map(n=>({name:n,type:accs[n].type,balance:accs[n].d-accs[n].c,d:accs[n].d,c:accs[n].c}))};window.calculateNetProfit=function(){let b=getTrialBalances(),s=(t)=>b.filter(a=>a.type===t).reduce((x,a)=>x+Math.abs(a.balance),0);return (s(_0xT[3])-s(_0xT[4]))+s(_0xT[6])-s(_0xT[5])};window.render=function(id){
if(id==='accountsPage'){const b=document.getElementById('accountsBody');b.innerHTML='';userDB.accounts.forEach((a,i)=>{let o=_0xT.map(t=>`<option ${a.type===t?'selected':''}>${t}</option>`).join('');b.innerHTML+=`<tr><td><input value="${a.name}" ${a.fixed?'readonly':''} onchange="userDB.accounts[${i}].name=this.value;updateDatalists()"></td><td><select onchange="userDB.accounts[${i}].type=this.value">${o}</select></td><td>${a.fixed?'ğŸ”’':`<button class="btn btn-del" onclick="userDB.accounts.splice(${i},1);render('accountsPage')">ğŸ—‘ï¸</button>`}</td></tr>`})}
if(id==='journalPage'){const b=document.getElementById('journalBody');b.innerHTML='';userDB.journal.forEach((j,i)=>{let pO=`<option value="">-- ØµÙ†Ù --</option>`+userDB.products.map(p=>`<option value="${p.name}" ${j.prod===p.name?'selected':''}>${p.name}</option>`).join('');b.innerHTML+=`<tr><td><input type="date" value="${j.date||''}" onchange="userDB.journal[${i}].date=this.value"></td><td><input list="accList" value="${j.deb||''}" onchange="userDB.journal[${i}].deb=this.value"></td><td><input list="accList" value="${j.cre||''}" onchange="userDB.journal[${i}].cre=this.value"></td><td><input list="partnerList" value="${j.name||''}" onchange="userDB.journal[${i}].name=this.value"></td><td><select onchange="updateRowPrice(${i},this.value)">${pO}</select></td><td><input type="number" id="q${i}" value="${j.q||0}" oninput="validateStock(${i})"></td><td><input type="number" id="v${i}" value="${j.v||0}" oninput="userDB.journal[${i}].v=this.value"></td><td><button class="btn btn-save" onclick="render('journalPage')">ğŸ’¾</button> <button class="btn btn-del" onclick="userDB.journal.splice(${i},1);render('journalPage')">ğŸ—‘ï¸</button></td></tr>`})}
if(id==='partnersPage'){const b=document.getElementById('partnersBody');b.innerHTML='';let pC={};userDB.journal.forEach(j=>{if(j.name){let n=j.name.trim();if(!pC[n])pC[n]={d:0,c:0};let v=parseFloat(j.v)||0;if(_0xL.includes(j.deb))pC[n].d+=v;if(_0xL.includes(j.cre))pC[n].c+=v}});userDB.partnersInfo.forEach((p,i)=>{let d=pC[p.name]?pC[p.name].d:0,c=pC[p.name]?pC[p.name].c:0,net=d-c;b.innerHTML+=`<tr><td><input value="${p.name}" onchange="userDB.partnersInfo[${i}].name=this.value;updateDatalists()"></td><td><input value="${p.phone||''}" onchange="userDB.partnersInfo[${i}].phone=this.value"></td><td><input value="${p.note||''}" onchange="userDB.partnersInfo[${i}].note=this.value"></td><td style="color:blue">${d}</td><td style="color:orange">${c}</td><td style="font-weight:bold;color:${net>=0?'green':'red'}">${net}</td><td><button class="btn btn-del" onclick="userDB.partnersInfo.splice(${i},1);render('partnersPage')">ğŸ—‘ï¸</button></td></tr>`})}
if(id==='trialPage'){const b=document.getElementById('trialBody');b.innerHTML='';getTrialBalances().forEach(a=>{b.innerHTML+=`<tr><td>${a.name}</td><td>${a.d}</td><td>${a.c}</td><td>${a.balance>0?a.balance:0}</td><td>${a.balance<0?Math.abs(a.balance):0}</td></tr>`})}
if(id==='incomePage'){const b=document.getElementById('incomeBody');b.innerHTML='';let bl=getTrialBalances(),s=(t)=>bl.filter(a=>a.type===t).reduce((v,a)=>v+Math.abs(a.balance),0),m=s(_0xT[3]),c=s(_0xT[4]),mj=m-c,n=mj+s(_0xT[6])-s(_0xT[5]);b.innerHTML=`<tr><td>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</td><td>${m}</td></tr><tr><td>(-) ØªÙƒÙ„ÙØ© Ø§Ù„Ø¨Ø¶Ø§Ø¹Ø©</td><td>${c}</td></tr><tr class="total-row"><td>Ù…Ø¬Ù…Ù„ Ø§Ù„Ø±Ø¨Ø­</td><td>${mj}</td></tr><tr class="total-row" style="background:#dcfce7"><td>ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­</td><td>${n}</td></tr>`}
if(id==='balanceSheetPage'){let bl=getTrialBalances(),ab=document.getElementById('assetsBody'),lb=document.getElementById('liabilitiesBody');ab.innerHTML='';lb.innerHTML='';let tA=0,tL=0;bl.forEach(a=>{if(a.type===_0xT[0]){let v=a.balance>0?a.balance:a.d;tA+=v;ab.innerHTML+=`<tr><td>${a.name}</td><td>${v}</td></tr>`}if([_0xT[1],_0xT[2]].includes(a.type)){let v=a.balance<0?Math.abs(a.balance):a.c;tL+=v;lb.innerHTML+=`<tr><td>${a.name}</td><td>${v}</td></tr>`}});let n=calculateNetProfit();tL+=n;lb.innerHTML+=`<tr style="background:#f0fdf4;font-weight:bold;color:var(--success)"><td>ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­</td><td>${n}</td></tr><tr class="total-row"><td>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</td><td>${tA}</td></tr><tr class="total-row"><td>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</td><td>${tL}</td></tr>`}
if(id==='productsPage'){const b=document.getElementById('productsBody');b.innerHTML='';userDB.products.forEach((p,i)=>{let c=parseFloat(p.op)||0;userDB.journal.forEach(j=>{if(j.prod===p.name){if(j.deb===_0xL[0])c+=parseFloat(j.q);if(j.cre===_0xL[0])c-=parseFloat(j.q)}});b.innerHTML+=`<tr><td><input value="${p.name||''}" onchange="userDB.products[${i}].name=this.value"></td><td><input type="number" value="${p.price||0}" onchange="userDB.products[${i}].price=this.value"></td><td><input type="number" value="${p.op||0}" onchange="userDB.products[${i}].op=this.value"></td><td>${c}</td><td><button class="btn btn-del" onclick="userDB.products.splice(${i},1);render('productsPage')">ğŸ—‘ï¸</button></td></tr>`})}
};window.validateStock=function(i){let j=userDB.journal[i];if(j.cre===_0xL[0]&&j.prod){let p=userDB.products.find(x=>x.name===j.prod),c=parseFloat(p.op)||0;userDB.journal.forEach((jj,idx)=>{if(idx!==i&&jj.prod===j.prod){if(jj.deb===_0xL[0])c+=parseFloat(jj.q)||0;if(jj.cre===_0xL[0])c-=parseFloat(jj.q)||0}});if(parseFloat(document.getElementById('q'+i).value)>c){alert("Ø§Ù„Ù…ØªØ§Ø­: "+c);document.getElementById('q'+i).value=0}}calcRowVal(i)};window.updateRowPrice=function(i,n){const p=userDB.products.find(x=>x.name===n);userDB.journal[i].prod=n;if(p){document.getElementById('v'+i).value=(parseFloat(p.price)||0)*(parseFloat(document.getElementById('q'+i).value)||0);userDB.journal[i].v=document.getElementById('v'+i).value}};window.calcRowVal=function(i){userDB.journal[i].q=document.getElementById('q'+i).value;const p=userDB.products.find(x=>x.name===userDB.journal[i].prod);if(p){document.getElementById('v'+i).value=(parseFloat(p.price)||0)*(parseFloat(userDB.journal[i].q)||0);userDB.journal[i].v=document.getElementById('v'+i).value}};window.addAcc=function(){userDB.accounts.push({name:'',type:'Ø£ØµÙˆÙ„',fixed:false});render('accountsPage')};window.addJ=function(){userDB.journal.push({date:new Date().toISOString().split('T')[0],q:0,v:0,deb:'',cre:'',name:'',prod:''});render('journalPage')};window.addP=function(){userDB.products.push({name:'',price:0,op:0});render('productsPage')};window.addPartnerInfo=function(){userDB.partnersInfo.push({name:'',phone:'',note:''});render('partnersPage')}})();
</script>
</body>
</html>
