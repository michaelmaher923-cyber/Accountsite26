<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ - Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…Ø­Ù…ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</title>
    <style>
        :root{--main:#1e293b;--accent:#0284c7;--bg:#f8fafc;--white:#ffffff;--danger:#be123c;--success:#059669}body{font-family:'Segoe UI',sans-serif;background:var(--bg);margin:0;color:#334155}#lic-err{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:#000;color:red;z-index:999999;justify-content:center;align-items:center;font-size:24px;font-weight:bold;text-align:center}header{background:var(--main);color:#fff;padding:15px 30px;display:flex;justify-content:space-between;align-items:center}.logo-img{width:40px;height:40px;background:var(--accent);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:20px}.page{display:none;padding:25px}.page.active{display:block}.table-container{background:var(--white);padding:20px;border-radius:12px;box-shadow:0 4px 6px -1px rgba(0,0,0,0.1);overflow-x:auto;margin-bottom:20px}table{width:100%;border-collapse:collapse;margin-top:10px}th{background:#f1f5f9;padding:12px;border:1px solid #e2e8f0;font-size:13px;color:var(--main)}td{padding:8px;border:1px solid #e2e8f0;text-align:center}input,select{width:92%;padding:8px;border:1px solid #cbd5e1;border-radius:4px;font-size:14px}.btn{padding:10px 20px;border:none;border-radius:6px;cursor:pointer;font-weight:700;transition:.2s}.btn-save{background:var(--success);color:#fff}.btn-del{background:var(--danger);color:#fff}.btn-add{background:var(--main);color:#fff;margin-bottom:15px}.nav-menu{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:15px;padding:20px}.card{background:#fff;padding:25px;border-radius:12px;text-align:center;cursor:pointer;border:1px solid #e2e8f0;transition:.3s}.auth-box{max-width:400px;margin:80px auto;background:#fff;padding:30px;border-radius:15px;box-shadow:0 20px 25px -5px rgba(0,0,0,0.1);text-align:center}.tabs{display:flex;margin-bottom:20px;border-bottom:2px solid #f1f5f9}.tab{flex:1;padding:10px;cursor:pointer;font-weight:700;color:#94a3b8}.tab.active{color:var(--accent);border-bottom:2px solid var(--accent)}#loader{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(255,255,255,0.8);z-index:9999;justify-content:center;align-items:center;flex-direction:column}
    </style>
</head>
<body>
<div id="lic-err">âš ï¸ Ø®Ø·Ø£ ÙØ§Ø¯Ø­: Ø§Ù„Ù†Ø³Ø®Ø© ØºÙŠØ± Ù…Ø±Ø®ØµØ© Ù„Ù„Ø¹Ù…Ù„ Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù†Ø·Ø§Ù‚.</div>
<div id="loader"><b>â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...</b></div>
<div id="secure-wrap" style="display:none">
    <div id="authScreen" class="auth-box">
        <div class="logo-img" style="margin:0 auto 20px;width:60px;height:60px;font-size:30px">ğŸ“ˆ</div>
        <div class="tabs"><div id="loginTab" class="tab active" onclick="switchAuth(true)">Ø¯Ø®ÙˆÙ„</div><div id="registerTab" class="tab" onclick="switchAuth(false)">Ø¬Ø¯ÙŠØ¯</div></div>
        <input type="text" id="username" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" style="margin-bottom:15px;width:100%"><input type="password" id="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" style="width:100%"><button class="btn btn-save" style="width:100%;margin-top:15px" onclick="processAuth()">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù†Ø¸Ø§Ù…</button>
    </div>
    <div id="appScreen" style="display:none">
        <header><div style="display:flex;align-items:center;gap:12px"><div class="logo-img">ğŸ“‰</div><h2 style="margin:0">Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ Ø§Ù„Ø°ÙƒÙŠ</h2></div><div style="display:flex;align-items:center;gap:15px"><span id="userDisplay"></span><button class="btn btn-save" onclick="syncToCloud()">Ø­ÙØ¸ Ø³Ø­Ø§Ø¨ÙŠ</button><button class="btn btn-del" onclick="logout()">Ø®Ø±ÙˆØ¬</button></div></header>
        <div id="homePage" class="page active"><div class="nav-menu"><div class="card" onclick="openPage('accountsPage')"><h3>ğŸ“ Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</h3></div><div class="card" onclick="openPage('journalPage')"><h3>ğŸ““ Ø¯ÙØªØ± Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h3></div><div class="card" onclick="openPage('productsPage')"><h3>ğŸ“¦ Ø­Ø±ÙƒØ© Ø§Ù„Ù…Ø®Ø²Ù†</h3></div><div class="card" onclick="openPage('partnersPage')"><h3>ğŸ¤ Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h3></div><div class="card" onclick="openPage('trialPage')"><h3>âš–ï¸ Ù…ÙŠØ²Ø§Ù† Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</h3></div><div class="card" onclick="openPage('incomePage')" style="background:#f0fdf4"><h3>ğŸ“Š Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø®Ù„</h3></div><div class="card" onclick="openPage('balanceSheetPage')" style="background:#eff6ff"><h3>ğŸ¦ Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ù…Ø§Ù„ÙŠ</h3></div><div class="card" onclick="openPage('guidePage')" style="background:#fffbeb"><h3>ğŸ“– Ø§Ù„Ø¯Ù„ÙŠÙ„</h3></div></div></div>
        <div id="accountsPage" class="page"><button class="btn btn-add" onclick="openPage('homePage')">â¬… Ø±Ø¬ÙˆØ¹</button><div class="table-container"><h3>Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</h3><button class="btn btn-add" onclick="addAcc()">+ Ø­Ø³Ø§Ø¨</button><table><thead><tr><th>Ø§Ù„Ø­Ø³Ø§Ø¨</th><th>Ø§Ù„Ù†ÙˆØ¹</th><th>Ø­Ø°Ù</th></tr></thead><tbody id="accountsBody"></tbody></table></div></div>
        <div id="journalPage" class="page"><button class="btn btn-add" onclick="openPage('homePage')">â¬… Ø±Ø¬ÙˆØ¹</button><div class="table-container"><button class="btn btn-add" onclick="addJ()">+ Ù‚ÙŠØ¯</button><table><thead><tr><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ù…Ø¯ÙŠÙ†</th><th>Ø¯Ø§Ø¦Ù†</th><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„ØµÙ†Ù</th><th>Ø§Ù„ÙƒÙ…ÙŠØ©</th><th>Ø§Ù„Ù…Ø¨Ù„Øº</th><th>Ø­Ø°Ù</th></tr></thead><tbody id="journalBody"></tbody></table></div></div>
        <div id="productsPage" class="page"><button class="btn btn-add" onclick="openPage('homePage')">â¬… Ø±Ø¬ÙˆØ¹</button><div class="table-container"><button class="btn btn-add" onclick="addP()">+ ØµÙ†Ù</button><table><thead><tr><th>Ø§Ù„ØµÙ†Ù</th><th>Ø§Ù„Ø³Ø¹Ø±</th><th>Ø£ÙˆÙ„ Ø§Ù„Ù…Ø¯Ø©</th><th>Ø§Ù„Ø­Ø§Ù„ÙŠ</th><th>Ø­Ø°Ù</th></tr></thead><tbody id="productsBody"></tbody></table></div></div>
        <div id="partnersPage" class="page"><button class="btn btn-add" onclick="openPage('homePage')">â¬… Ø±Ø¬ÙˆØ¹</button><div class="table-container"><h3>ÙƒØ´ÙˆÙ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</h3><button class="btn btn-add" onclick="addPartnerInfo()">+ Ù…ØªØ¹Ø§Ù…Ù„</button><table><thead><tr><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ù‡Ø§ØªÙ</th><th>Ù…Ø¯ÙŠÙ†</th><th>Ø¯Ø§Ø¦Ù†</th><th>Ø§Ù„ØµØ§ÙÙŠ</th><th>Ø­Ø°Ù</th></tr></thead><tbody id="partnersBody"></tbody></table></div></div>
        <div id="trialPage" class="page"><button class="btn btn-add" onclick="openPage('homePage')">â¬… Ø±Ø¬ÙˆØ¹</button><div class="table-container"><h3>Ù…ÙŠØ²Ø§Ù† Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</h3><table><thead><tr><th>Ø§Ù„Ø­Ø³Ø§Ø¨</th><th>Ù…Ø¯ÙŠÙ†</th><th>Ø¯Ø§Ø¦Ù†</th><th>Ø±ØµÙŠØ¯ Ù…</th><th>Ø±ØµÙŠØ¯ Ø¯</th></tr></thead><tbody id="trialBody"></tbody></table></div></div>
        <div id="incomePage" class="page"><button class="btn btn-add" onclick="openPage('homePage')">â¬… Ø±Ø¬ÙˆØ¹</button><div class="table-container"><h2 style="text-align:center">ğŸ“Š Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø®Ù„</h2><table><tbody id="incomeBody"></tbody></table></div></div>
        <div id="balanceSheetPage" class="page"><button class="btn btn-add" onclick="openPage('homePage')">â¬… Ø±Ø¬ÙˆØ¹</button><div style="display:grid;grid-template-columns:1fr 1fr;gap:20px"><div class="table-container"><h3>Ø§Ù„Ø£ØµÙˆÙ„</h3><table><tbody id="assetsBody"></tbody></table></div><div class="table-container"><h3>Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª</h3><table><tbody id="liabilitiesBody"></tbody></table></div></div></div>
        <div id="guidePage" class="page"><button class="btn btn-add" onclick="openPage('homePage')">â¬… Ø±Ø¬ÙˆØ¹</button><div class="table-container"><h2>ğŸ“– Ø§Ù„Ø¯Ù„ÙŠÙ„</h2><p>Ù†Ø¸Ø§Ù… Ù…Ø­Ø§Ø³Ø¨ÙŠ Ù…ØªÙƒØ§Ù…Ù„ Ù„Ù„Ø£Ø³ØªØ§Ø° Ù…Ø§ÙŠÙƒÙ„ Ù…Ø§Ù‡Ø±.</p></div></div>
    </div>
</div>
<datalist id="accList"></datalist><datalist id="partnerList"></datalist>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, set, get } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";
import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

const _0x1a2b=["\x68\x6f\x73\x74\x6e\x61\x6d\x65","\x6c\x6f\x63\x61\x74\x69\x6f\x6e","\x6d\x69\x63\x68\x61\x65\x6c\x6d\x61\x68\x65\x72\x39\x32\x33\x2d\x63\x79\x62\x65\x72\x2e\x67\x69\x74\x68\x75\x62\x2e\x69\x6f","\x64\x69\x73\x70\x6c\x61\x79","\x73\x74\x79\x6c\x65","\x6c\x69\x63\x2d\x65\x72\x72","\x67\x65\x74\x45\x6c\x65\x6d\x65\x6e\x74\x42\x79\x49\x64","\x66\x6c\x65\x78","\x73\x65\x63\x75\x72\x65\x2d\x77\x72\x61\x70","\x62\x6c\x6f\x63\x6b"];
(function(){if(window[_0x1a2b[1]][_0x1a2b[0]]!==_0x1a2b[2]){document[_0x1a2b[6]](_0x1a2b[5])[_0x1a2b[4]][_0x1a2b[3]]=_0x1a2b[7]}else{document[_0x1a2b[6]](_0x1a2b[8])[_0x1a2b[4]][_0x1a2b[3]]=_0x1a2b[9]}})();

const firebaseConfig = { apiKey: "AIzaSyBP7HP1w4MbOFZWnv7BdpKwDlYjv4VJUTM", authDomain: "accountsite26.firebaseapp.com", databaseURL: "https://accountsite26-default-rtdb.firebaseio.com", projectId: "accountsite26", storageBucket: "accountsite26.firebasestorage.app", messagingSenderId: "1015795938039", appId: "1:1015795938039:web:b625e24fca2c5b231d19f2" };
const app = initializeApp(firebaseConfig); const db = getDatabase(app); const auth = getAuth(app);

window.processAuth=async()=>{const u=document.getElementById('username').value.trim(),p=document.getElementById('password').value.trim(),is=document.getElementById('loginTab').classList.contains('active');if(!u||p.length<6)return alert("Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ÙƒØ§ÙÙŠØ©");document.getElementById('loader').style.display='flex';const e=u.toLowerCase().replace(/[^a-z0-9]/g,"")+"@maher.com";try{if(is)await signInWithEmailAndPassword(auth,e,p);else await createUserWithEmailAndPassword(auth,e,p)}catch(x){alert("ÙØ´Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„");document.getElementById('loader').style.display='none'}};
onAuthStateChanged(auth,async(u)=>{if(u){window.currentUser=u.email.split('@')[0];const s=await get(ref(db,`users/${u.uid}/data`));const d=s.exists()?s.val():{};window.userDB={accounts:d.accounts||[],journal:d.journal||[],products:d.products||[],partnersInfo:d.partnersInfo||[]};initFixedAccounts();startApp()}});
window.syncToCloud=async()=>{if(!auth.currentUser)return;document.getElementById('loader').style.display='flex';try{await set(ref(db,`users/${auth.currentUser.uid}/data`),window.userDB);alert("âœ… ØªÙ… Ø§Ù„Ø­ÙØ¸")}catch(x){alert("âŒ ÙØ´Ù„")}document.getElementById('loader').style.display='none'};
window.logout=()=>signOut(auth).then(()=>location.reload());

const FIXED=["Ø§Ù„Ù…Ø®Ø²ÙˆÙ†","Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡","Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†","Ø§Ù„Ù…Ø¯ÙŠÙ†ÙˆÙ†","Ø§Ù„Ø¯Ø§Ø¦Ù†ÙˆÙ†"],TYPES=["Ø£ØµÙˆÙ„","Ø§Ù„ØªØ²Ø§Ù…Ø§Øª","Ø­Ù‚ÙˆÙ‚ Ù…Ù„ÙƒÙŠØ©","Ù…Ø¨ÙŠØ¹Ø§Øª","ØªÙƒÙ„ÙØ© Ù…Ø¨ÙŠØ¹Ø§Øª","Ù…ØµØ±ÙˆÙØ§Øª","Ø¥ÙŠØ±Ø§Ø¯Ø§Øª"];
window.initFixedAccounts=()=>{FIXED.forEach(n=>{if(!window.userDB.accounts.find(a=>a.name===n)){let t=(n==="Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†"||n==="Ø§Ù„Ø¯Ø§Ø¦Ù†ÙˆÙ†")?'Ø§Ù„ØªØ²Ø§Ù…Ø§Øª':'Ø£ØµÙˆÙ„';window.userDB.accounts.push({name:n,type:t,fixed:true})}})}
window.startApp=()=>{document.getElementById('authScreen').style.display='none';document.getElementById('appScreen').style.display='block';document.getElementById('loader').style.display='none';document.getElementById('userDisplay').innerText="ğŸ‘¤ "+window.currentUser;uDL()}
window.switchAuth=(m)=>{document.getElementById('loginTab').classList.toggle('active',m);document.getElementById('registerTab').classList.toggle('active',!m)}
window.openPage=(id)=>{document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));document.getElementById(id).classList.add('active');render(id.replace('Page',''))}
const uDL=()=>{document.getElementById('accList').innerHTML=window.userDB.accounts.map(a=>`<option value="${a.name}">`).join('');document.getElementById('partnerList').innerHTML=window.userDB.partnersInfo.map(p=>`<option value="${p.name}">`).join('')}

const getB=()=>{let r={};window.userDB.accounts.forEach(a=>r[a.name]={d:0,c:0,t:a.type});window.userDB.journal.forEach(j=>{if(r[j.deb])r[j.deb].d+=parseFloat(j.v)||0;if(r[j.cre])r[j.cre].c+=parseFloat(j.v)||0});return Object.keys(r).map(n=>({name:n,t:r[n].t,d:r[n].d,c:r[n].c,bal:r[n].d-r[n].c}))};
const getNP=()=>{let b=getB(),s=(t)=>b.filter(x=>x.t===t).reduce((a,c)=>a+Math.abs(c.bal),0);return (s('Ù…Ø¨ÙŠØ¹Ø§Øª')-s('ØªÙƒÙ„ÙØ© Ù…Ø¨ÙŠØ¹Ø§Øª'))+(s('Ø¥ÙŠØ±Ø§Ø¯Ø§Øª'))-(s('Ù…ØµØ±ÙˆÙØ§Øª'))};

window.render=(id)=>{const b=document.getElementById(id+'Body');if(!b)return;b.innerHTML='';const bals=getB();
if(id==='accounts'){window.userDB.accounts.forEach((a,i)=>{let o=TYPES.map(t=>`<option ${a.type==t?'selected':''}>${t}</option>`).join('');b.innerHTML+=`<tr><td><input value="${a.name}" ${a.fixed?'readonly':''} onchange="window.userDB.accounts[${i}].name=this.value;uDL()"></td><td><select onchange="window.userDB.accounts[${i}].type=this.value">${o}</select></td><td>${a.fixed?'ğŸ”’':`<button class="btn btn-del" onclick="window.userDB.accounts.splice(${i},1);render('accounts')">ğŸ—‘ï¸</button>`}</td></tr>`})}
if(id==='journal'){window.userDB.journal.forEach((j,i)=>{let pO=`<option value="">-- ØµÙ†Ù --</option>`+window.userDB.products.map(p=>`<option value="${p.name}" ${j.prod===p.name?'selected':''}>${p.name}</option>`).join('');b.innerHTML+=`<tr><td><input type="date" value="${j.date}" onchange="window.userDB.journal[${i}].date=this.value"></td><td><input list="accList" value="${j.deb}" onchange="window.userDB.journal[${i}].deb=this.value"></td><td><input list="accList" value="${j.cre}" onchange="window.userDB.journal[${i}].cre=this.value"></td><td><input list="partnerList" value="${j.name||''}" onchange="window.userDB.journal[${i}].name=this.value"></td><td><select onchange="uRP(${i},this.value)">${pO}</select></td><td><input type="number" id="q${i}" value="${j.q}" oninput="vS(${i})"></td><td><input type="number" id="v${i}" value="${j.v}" oninput="window.userDB.journal[i].v=this.value"></td><td><button class="btn btn-del" onclick="window.userDB.journal.splice(${i},1);render('journal')">ğŸ—‘ï¸</button></td></tr>`})}
if(id==='products'){window.userDB.products.forEach((p,i)=>{let c=parseFloat(p.op)||0;window.userDB.journal.forEach(j=>{if(j.prod===p.name){if(j.deb==="Ø§Ù„Ù…Ø®Ø²ÙˆÙ†")c+=parseFloat(j.q)||0;if(j.cre==="Ø§Ù„Ù…Ø®Ø²ÙˆÙ†")c-=parseFloat(j.q)||0}});b.innerHTML+=`<tr><td><input value="${p.name}" onchange="window.userDB.products[${i}].name=this.value;uDL()"></td><td><input type="number" value="${p.price}" onchange="window.userDB.products[${i}].price=this.value"></td><td><input type="number" value="${p.op}" onchange="window.userDB.products[${i}].op=this.value"></td><td>${c}</td><td><button class="btn btn-del" onclick="window.userDB.products.splice(${i},1);render('products')">ğŸ—‘ï¸</button></td></tr>`})}
if(id==='partners'){let pC={};window.userDB.journal.forEach(j=>{if(j.name){let n=j.name.trim();if(!pC[n])pC[n]={d:0,c:0};if(["Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡","Ø§Ù„Ù…Ø¯ÙŠÙ†ÙˆÙ†","Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†","Ø§Ù„Ø¯Ø§Ø¦Ù†ÙˆÙ†"].includes(j.deb))pC[n].d+=parseFloat(j.v)||0;if(["Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡","Ø§Ù„Ù…Ø¯ÙŠÙ†ÙˆÙ†","Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†","Ø§Ù„Ø¯Ø§Ø¦Ù†ÙˆÙ†"].includes(j.cre))pC[n].c+=parseFloat(j.v)||0}});window.userDB.partnersInfo.forEach((p,i)=>{let d=pC[p.name]?.d||0,c=pC[p.name]?.c||0,n=d-c;b.innerHTML+=`<tr><td><input value="${p.name}" onchange="window.userDB.partnersInfo[${i}].name=this.value;uDL()"></td><td>${p.phone||''}</td><td>${d}</td><td>${c}</td><td style="color:${n>=0?'green':'red'}">${n}</td><td><button class="btn btn-del" onclick="window.userDB.partnersInfo.splice(${i},1);render('partners')">ğŸ—‘ï¸</button></td></tr>`})}
if(id==='trial'){bals.forEach(a=>b.innerHTML+=`<tr><td>${a.name}</td><td>${a.d}</td><td>${a.c}</td><td>${a.bal>0?a.bal:0}</td><td>${a.bal<0?Math.abs(a.bal):0}</td></tr>`)}
if(id==='income'){let s=(t)=>bals.filter(x=>x.t===t).reduce((a,c)=>a+Math.abs(c.bal),0),m=s('Ù…Ø¨ÙŠØ¹Ø§Øª'),c=s('ØªÙƒÙ„ÙØ© Ù…Ø¨ÙŠØ¹Ø§Øª'),np=getNP();b.innerHTML=`<tr><td>Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</td><td>${m}</td></tr><tr><td>Ø§Ù„ØªÙƒÙ„ÙØ©</td><td>${c}</td></tr><tr style="background:#dcfce7"><td>ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­</td><td>${np}</td></tr>`}
if(id==='balanceSheet'){let tA=0,tL=0,ab=document.getElementById('assetsBody'),lb=document.getElementById('liabilitiesBody');ab.innerHTML='';lb.innerHTML='';bals.forEach(a=>{if(a.t==='Ø£ØµÙˆÙ„'){tA+=a.bal;ab.innerHTML+=`<tr><td>${a.name}</td><td>${a.bal}</td></tr>`}if(['Ø§Ù„ØªØ²Ø§Ù…Ø§Øª','Ø­Ù‚ÙˆÙ‚ Ù…Ù„ÙƒÙŠØ©'].includes(a.t)){tL+=Math.abs(a.bal);lb.innerHTML+=`<tr><td>${a.name}</td><td>${Math.abs(a.bal)}</td></tr>`}});let np=getNP();tL+=np;lb.innerHTML+=`<tr style="color:green"><td>Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø¹Ø§Ù…</td><td>${np}</td></tr><tr><td><b>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</b></td><td><b>${tA}</b></td></tr>`;ab.innerHTML+=`<tr><td><b>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</b></td><td><b>${tA}</b></td></tr>`}};
window.vS=(i)=>{let j=window.userDB.journal[i];if(j.cre==="Ø§Ù„Ù…Ø®Ø²ÙˆÙ†"){let p=window.userDB.products.find(x=>x.name===j.prod),cur=parseFloat(p?.op)||0;window.userDB.journal.forEach((jj,idx)=>{if(idx!==i&&jj.prod===j.prod){if(jj.deb==="Ø§Ù„Ù…Ø®Ø²ÙˆÙ†")cur+=parseFloat(jj.q)||0;if(jj.cre==="Ø§Ù„Ù…Ø®Ø²ÙˆÙ†")cur-=parseFloat(jj.q)||0}});if(parseFloat(document.getElementById('q'+i).value)>cur){alert("Ø§Ù„Ù…ØªØ§Ø­ ÙÙ‚Ø·: "+cur);document.getElementById('q'+i).value=0}}uRV(i)};
window.uRV=(i)=>{window.userDB.journal[i].q=document.getElementById('q'+i).value;let p=window.userDB.products.find(x=>x.name===window.userDB.journal[i].prod);if(p){let v=(parseFloat(p.price)||0)*(parseFloat(window.userDB.journal[i].q)||0);document.getElementById('v'+i).value=v;window.userDB.journal[i].v=v}};
window.uRP=(i,n)=>{window.userDB.journal[i].prod=n;uRV(i)};
window.addAcc=()=>{window.userDB.accounts.push({name:'',type:'Ø£ØµÙˆÙ„',fixed:false});render('accounts')};
window.addJ=()=>{window.userDB.journal.push({date:new Date().toISOString().split('T')[0],q:0,v:0,deb:'',cre:'',name:'',prod:''});render('journal')};
window.addP=()=>{window.userDB.products.push({name:'',price:0,op:0});render('products')};
window.addPartnerInfo=()=>{window.userDB.partnersInfo.push({name:'',phone:'',note:''});render('partners')};
</script>
</body>
</html>
